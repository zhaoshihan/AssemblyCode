DATA	SEGMENT
COUNT	EQU	30
FIRST	DB	3 DUP(0)
SECOND	DB	1,0,0
REMAIN	DW	0
DATA	ENDS

CODE	SEGMENT
ASSUME	CS:CODE,DS:DATA,
START:	MOV AX,DATA
	MOV DS,AX
	MOV BH,0
	
AGAIN:	INC BH
	MOV DI,OFFSET SECOND
	SUB DH,DH	;DH=0
	MOV AL,[DI]
	INC DI
	MOV AH,[DI]
	INC DI
	MOV DL,[DI]
	CALL PRINT
	
	MOV SI,OFFSET FIRST
	MOV DI,OFFSET SECOND
	SUB BL,BL	;BL记录进位
	MOV AL,[SI]
	ADD AL,[DI]
	JNC NEXT2
	INC BL
	
NEXT2:	MOV CL,[DI]	;CHANGE FIRST
	MOV [SI],CL
	MOV [DI],AL	;CHANGE SECOND
	INC SI
	INC DI
	MOV AH,BL
	SUB BL,BL	;BL记录进位
	ADD AH,[SI]	
	JNC NEXT3
	INC BL
	
NEXT3:	ADD AH,[DI]	
	JNC NEXT4
	INC BL
	
NEXT4:	MOV CL,[DI]	;CHANGE FIRST
	MOV [SI],CL
	MOV [DI],AH	;CHANGE SECOND
	INC SI
	INC DI
	MOV DL,BL
	ADD DL,[SI]
	ADD DL,[DI]
	MOV CL,[DI]	;CHANGE FIRST
	MOV [SI],CL
	MOV [DI],DL	;CHANGE SECOND

	CMP BH,COUNT
	JB AGAIN	; BH<30,CONTINUE
	;SUB DH,DH
	;MOV DX,0
	;MOV AX,0179H
	;CALL PRINT
	
	MOV AX,4C00H
	INT 21H
	
PRINT	PROC NEAR
	MOV CX, 10000
	DIV CX		;AX=商，DX=余数
	MOV SI,OFFSET REMAIN
	MOV [SI],DX	;STORE REMAIN IN SI
			
	MOV AH,0	;商最大为83，在AL中
	MOV DL,10
	DIV DL
	XCHG AH,AL
	ADD AX,3030H
	MOV CX,AX
	MOV DL,CH
	MOV AH,2
	INT 21H
	MOV DL,CL
	MOV AH,2
	INT 21H	
	
	MOV AX,[SI]	;0-9999
	SUB DX,DX
	MOV CX,1000
	DIV CX		;AX=商，DX=余数
	MOV [SI],DX	;SI保存余数
	
	ADD AL,30H
	MOV DL,AL
	MOV AH,2
	INT 21H
	
	MOV AX,[SI]	;0-999
	MOV CL,100
	DIV CL		;AL=商,AH=余数
	MOV [SI],AH	;SI保存余数
	
	ADD AL,30H
	MOV DL,AL
	MOV AH,2
	INT 21H
	
	MOV AX,[SI]	;0-99
	MOV AH,0	;尾数在AL中
	MOV DL,10
	DIV DL
	XCHG AH,AL
	ADD AX,3030H
	MOV CX,AX
	MOV DL,CH
	MOV AH,2
	INT 21H
	MOV DL,CL
	MOV AH,2
	INT 21H	
	
	MOV DL,	32
	MOV AH,2
	INT 21H	
EXIT:	RET
PRINT	ENDP	

CODE	ENDS
END	START
